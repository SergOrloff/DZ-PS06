# Cохранение результатов парсинга в файлы форматов CSV и XLSX 

## Назначение

Данная программа предназначена для парсинга данных о светильниках с веб-сайта [divan.ru](https://www.divan.ru/category/svet). Программа использует библиотеку Selenium для автоматизации веб-браузера и извлечения информации о названии, цене и ссылке на светильники. Полученные данные сохраняются в файлы форматов CSV и XLSX с уникальными именами, основанными на текущей дате и времени.

## Порядок развертывания

### Требования

- Python 3.x
- Установленные библиотеки:
  - selenium
  - openpyxl
- Установленный веб-драйвер для Chrome (например, ChromeDriver)

### Установка зависимостей

Перед началом работы необходимо установить все необходимые зависимости. Это можно сделать с помощью менеджера пакетов `pip`:

```bash
pip install selenium openpyxl
```

### Настройка веб-драйвера

Убедитесь, что у вас установлен ChromeDriver, соответствующий версии вашего браузера Chrome. Скачайте ChromeDriver с официального сайта и добавьте его в `PATH` или укажите путь к `chromedriver` в коде:

```python
driver = webdriver.Chrome(executable_path='/path/to/chromedriver')
```

### Запуск программы

1. Скачайте или скопируйте код программы в файл с расширением `.py`, например `parse_lamps.py`.
2. Запустите программу через терминал или командную строку:

```bash
python main_dz.py
```

## Организация парсинга данных

### Как находить селекторы

Для корректного парсинга элементов на веб-странице необходимо указать правильные CSS-селекторы или селекторы по классу/атрибуту. В этой программе используются следующие селекторы:

- **Класс элемента светильника**: `'_Ud0k'`
- **Название светильника**: `span[itemprop="name"]`
- **Цена светильника**: `span.ui-LD-ZU`
- **Ссылка на светильник**: `link[itemprop="url"]`

Чтобы найти селекторы для других элементов, можно использовать инструменты разработчика в браузере (обычно доступные по правому клику на элементе с выбором "Inspect" или "Просмотр кода элемента"). В консоли разработчика вы можете увидеть структуру HTML и определить нужные селекторы.

### Обработка данных

Программа извлекает данные с веб-страницы и сохраняет их в список `parsed_data`. В случае успешного извлечения данных они записываются в CSV-файл, который затем конвертируется в XLSX-файл.

## Обработка ошибок

Во время выполнения программы предусмотрена обработка исключений, чтобы избежать прерывания работы при возникновении ошибок при парсинге. Все ошибки выводятся в консоль с сообщением об ошибке.